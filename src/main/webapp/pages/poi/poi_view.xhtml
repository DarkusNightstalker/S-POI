<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <script src="#{request.contextPath}/js/pages/report_view.js"/>
    <script src="#{request.contextPath}/js/pages/poi_view.js"/>
    <div id="ribbon">
        <span class="ribbon-button-alignment"> 
            <span id="refresh" class="btn btn-ribbon" data-action="resetWidgets" data-title="refresh"  rel="tooltip" data-placement="bottom" data-html="true">
                <i class="fa fa-refresh"></i>
            </span> 
        </span>
        <ol class="breadcrumb">
            <li>Inicio</li><li>Operaciones</li><li>Plan Operativo Institucional</li>
        </ol>
    </div>
    <div id="content">
        <div class="inbox-nav-bar no-content-padding">
            <h1 class="page-title txt-color-blueDark w animated fadeInDown fast" style="width: auto"><strong>Plan Operativo Interno</strong>&nbsp;#{sessionBean.operationYear}&nbsp;&nbsp;&nbsp;
            </h1>
            <div class="inbox-checkbox-triggered">
                <h:form>
                    <div class="btn-group">
                        <p:commandLink process="@this" update=":manage-wrapper" styleClass="btn btn-default" oncomplete="$('#modal-manage').modal()" action="#{managedPOIBean.create()}">
                            <strong><i class="fa fa-plus fa-lg text-success"></i></strong>
                        </p:commandLink>
                        <p:commandLink rendered="#{sessionBean.authorize('VA_POI')}" process="@this" update=":chooser-form" styleClass="btn btn-default" oncomplete="$('#modal-chooser').modal({backdrop:'static',keyboard:false})" action="#{poiBean.refresh()}">
                            <strong><i class="fa fa-search fa-lg text-warning"></i></strong>
                        </p:commandLink>
                        <p:commandLink styleClass="deletebutton btn btn-default">
                            <strong><i class="fa fa-check fa-lg text-info"></i></strong>
                        </p:commandLink>
                    </div>
                </h:form>
            </div>
            <a href="javascript:void(0);" id="compose-mail-mini" class="btn btn-primary pull-right hidden-desktop visible-tablet"> 
                <strong><i class="fa fa-file fa-lg"></i></strong> </a>
            <span class="pull-right"></span>
        </div>

        <div id="inbox-content" class="inbox-body no-content-padding animated fast fadeInRight">
            <div class="table-wrap custom-scroll" style="margin-left: 0px">
                <table class="table eg-1">
                    <tbody>
                        <tr>
                            <td>
                                <h3>Información Basica</h3>
                                <p><strong>Código      : </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#{viewPOIBean.selected.dependency.path}</p>
                                <p><strong>Dependencia : </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#{viewPOIBean.selected.dependency.name}</p>
                                <ui:fragment rendered="#{viewPOIBean.selected.editDate ne null}">
                                    <p class="pull-right text-success"><i>Aprobado el <h:outputText value="#{viewPOIBean.selected.editDate}"><f:convertDateTime pattern="dd/MM/yyyy hh:mm a"/></h:outputText></i></p>
                                </ui:fragment>
                                <ui:fragment rendered="#{viewPOIBean.selected.editDate eq null}">
                                    <p class="pull-right text-danger"><i>No aprobado</i></p>
                                </ui:fragment>
                            </td>
                        </tr>
                        <tr id="auditory">
                            <td>
                                <h3>Actividades <button type="button" onclick="if ($(this).hasClass('active')) {
                                            $(this).removeClass('active');
                                        } else {
                                            $(this).addClass('active');
                                        }
                                        $('#filter-summary').toggle('fast');
                                        $('#filter-act').toggle('fast')" class="btn btn-xs btn-primary"><i class="fa fa-filter"/></button>
                                    <button type="button" onclick="refresh()" class="btn btn-xs btn-warning"><i class="fa fa-refresh"/></button></h3>

                                <h:form id="filter-act" style="display: none;padding: 10px" styleClass="form-horizontal well well-lg">
                                    <p:remoteCommand name="refresh" process="@this" action="#{viewPOIBean.refresh()}" update=":filter-act,:form-table,:summary-filter" />
                                    <div class="form-group">
                                        <label class="control-label col-md-1">Eje. est.</label>
                                        <div class="col-md-11">
                                            <script>
                                                $(function () {
                                                    $("#filter-act\\:filter-3").select2({
                                                        placeholder: 'Seleccione un eje estratégico',
                                                        width: '100%'
                                                    });
                                                });
                                            </script>
                                            <h:selectOneMenu id="filter-3" value="#{viewPOIBean.strategicAxisSearcher.selected}">
                                                <f:selectItem/>
                                                <f:selectItems value="#{viewPOIBean.strategicAxisSearcher.data}" var="item" itemValue="#{item[0]}" itemLabel="#{item[1]} || #{item[2]}"/>
                                                <p:ajax event="change" listener="#{viewPOIBean.strategicAxisSearcher.change()}" process="filter-3" update="filter-act:act-wrapper,filter-act:meta-wrapper,:form-table,:summary-filter"/>
                                            </h:selectOneMenu>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-1">Act. estr.</label>
                                        <h:panelGroup id="act-wrapper" layout="block" class="col-md-11">
                                            <script>
                                                $(function () {
                                                    $("#filter-act\\:filter-5").select2({
                                                        placeholder: 'Seleccione un actividad estrategica',
                                                        width: '100%'
                                                    });
                                                });
                                            </script>
                                            <h:selectOneMenu id="filter-5" value="#{viewPOIBean.specificActivitySearcher.selected}">
                                                <f:selectItem/>
                                                <f:selectItems value="#{viewPOIBean.specificActivitySearcher.data}" var="item" itemValue="#{item[0]}" itemLabel="#{item[1]} || #{item[2]}"/>
                                                <p:ajax event="change" listener="#{viewPOIBean.updateActivities()}" process="filter-5" update=":form-table,:summary-filter" />
                                            </h:selectOneMenu>

                                        </h:panelGroup>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-1">Meta</label>
                                        <h:panelGroup id="meta-wrapper" layout="block" class="col-md-5">
                                            <script>
                                                $(function () {
                                                    $("#filter-act\\:filter-1").select2({
                                                        placeholder: 'Seleccione una meta',
                                                        width: '100%'
                                                    });
                                                });
                                            </script>
                                            <h:selectOneMenu id="filter-1" value="#{viewPOIBean.metaSearcher.selected}">
                                                <f:selectItem/>
                                                <f:selectItems value="#{viewPOIBean.metaSearcher.data}" var="item" itemValue="#{item[0]}" itemLabel="#{item[1]} || #{item[2]}"/>
                                                <p:ajax event="change" listener="#{viewPOIBean.updateActivities()}" process="filter-1" update=":form-table,:summary-filter"/>
                                            </h:selectOneMenu>
                                        </h:panelGroup>
                                        <label class="control-label col-md-1">Unidad</label>
                                        <h:panelGroup layout="block" id="pu-wrapper" class="col-md-5">
                                            <script>
                                                $(function () {
                                                    $("#filter-act\\:filter-2").select2({
                                                        placeholder: 'Seleccione una unidad',
                                                        width: '100%'
                                                    });
                                                });
                                            </script>
                                            <h:selectOneMenu id="filter-2" value="#{viewPOIBean.poiUnitySearcher.selected}">
                                                <f:selectItem/>
                                                <f:selectItems value="#{viewPOIBean.poiUnitySearcher.data}" var="item" itemValue="#{item[0]}" itemLabel="#{item[1]} || #{item[2]}"/>
                                                <p:ajax event="change" listener="#{viewPOIBean.updateActivities()}" process="filter-2" update=":form-table,:summary-filter"/>
                                            </h:selectOneMenu>
                                        </h:panelGroup>
                                    </div>
                                </h:form>
                                <div class="form-horizontal" id="filter-summary">
                                    <h:panelGroup id="summary-filter" layout="block" class="form-group">
                                        <div class="col-md-12">
                                            <p class="form-control-static"><h:outputText value="#{viewPOIBean.summaryWrapper}" escape="false"></h:outputText></p>
                                        </div>
                                    </h:panelGroup>
                                </div>
                                <div class="row padding-left-lg">
                                    <h:form id="form-table"> 
                                        <p:remoteCommand name="recovery" action="#{managedPOIBean.recovery(viewPOIBean.selectedId)}"  oncomplete="search()"/>

                                        <p:remoteCommand name="del" action="#{managedPOIBean.delete(viewPOIBean.selectedId)}"  oncomplete="search()" />
                                        <p:remoteCommand name="search" action="#{viewPOIBean.updateActivities()}" update=":form-table" />

                                        <div class="table-responsive">
                                            <script>
                                                $(function () {
                                                    $("#datatable tbody").on("click", "button.btn-expand", function () {
                                                        var tr = $(this).closest("tr").next("tr");
                                                        if (tr.css("display") === "none") {
                                                            $(this).find("i").removeClass("fa-plus").addClass("fa-minus");
                                                            $(this).removeClass("btn-success").addClass("btn-danger");
                                                        } else {
                                                            $(this).find("i").addClass("fa-plus").removeClass("fa-minus");
                                                            $(this).removeClass("btn-danger").addClass("btn-success");

                                                        }
                                                        tr.toggle("fast");
                                                    });
                                                    $(".pei-label").removeClass("ui-commandlink ui-widget");
                                                });
                                            </script>
                                            <div class="dataTables_wrapper form-inline no-footer">

                                                <ui:include src="/layout/pagination_header.xhtml">
                                                    <ui:param name="pagination" value="#{viewPOIBean.pagination}"/>
                                                    <ui:param name="order_factory" value="#{viewPOIBean.orderFactory}"/>
                                                    <ui:param name="update_script" value="search"/>
                                                </ui:include>
                                                <table id="datatable" class="table table-striped  table-condensed table-bordered table-hover table-forum">
                                                    <thead>
                                                        <tr>
                                                            <td style="width: 40px;min-width: 40px;max-width: 40px"></td>
                                                            <td class="col-md-1 text-center"><strong>C&oacute;digo</strong></td>
                                                            <td class="col-md-10 col-sm-4 col-xs-5"><strong>Actividad</strong></td>
                                                            <td class="col-md-1 text-center"><strong>Meta</strong></td>
                                                            <td class="text-center" style="width: 50px"><strong>Total</strong></td>
                                                            <td style="width: 100px;min-width: 100px;max-width: 100px"></td>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <ui:repeat value="#{viewPOIBean.pagination.data}" var="item">
                                                            <tr class="#{item['active'] ? '' : 'danger'}">
                                                                <td><button type="button" class="btn btn-expand btn-xs btn-success"><i class="fa fa-plus"/></button></td>
                                                                <th scope="row" style="vertical-align: middle !important" class="text-center">#{item['code']}</th >
                                                                <td class="font-sm" style="vertical-align: middle !important">#{item['name']}.</td>
                                                                <td style="vertical-align: middle !important" class="text-center"><p:commandLink>#{item['functionalSequence'] eq null ? '????' : item['functionalSequence']} <i class="fa fa-sign-in"/></p:commandLink></td>

                                                                <td style="vertical-align: middle !important" class="text-center">#{item['total']}</td>
                                                                <td style="vertical-align: middle !important" class="text-center">


                                                                    <div class="btn-group">
                                                                        <ui:fragment rendered="#{item['active']}">
                                                                            <p:commandLink onclick="$(this).blur()" process="@this" update=":manage-wrapper" oncomplete="$('#modal-manage').modal()"   styleClass="btn btn-warning btn-xs">
                                                                                <i class="fa fa-edit"></i>
                                                                                <f:setPropertyActionListener target="#{managedPOIBean.idSelected}" value="#{item['id']}" />
                                                                            </p:commandLink>
                                                                            <p:commandLink onclick="$(this).blur()" process="@this" styleClass="btn btn-danger btn-xs" oncomplete="POIView.delete('#{item[1]}')">
                                                                                <i class="fa fa-trash-o"></i>
                                                                                <f:setPropertyActionListener target="#{viewPOIBean.selectedId}" value="#{item['id']}" />
                                                                            </p:commandLink>
                                                                        </ui:fragment>
                                                                        <ui:fragment rendered="#{not item['active']}">
                                                                            <p:commandLink onclick="$(this).blur()" process="@this" styleClass="btn btn-success btn-xs" oncomplete="POIView.recovery('#{item[1]}')">
                                                                                Restaurar
                                                                                <f:setPropertyActionListener target="#{viewPOIBean.selectedId}" value="#{item['id']}" />
                                                                            </p:commandLink>
                                                                        </ui:fragment>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr  style="display: none">
                                                                <td style="background: rgb(249, 249, 249)" ></td>
                                                                <td colspan="6"> 
                                                                    <table class="table table-forum ">
                                                                        <tbody>
                                                                            <tr>
                                                                                <td class="text-center" style="width: 40px;"><i class="fa fa-calendar fa-2x text-muted"></i></td>
                                                                                <td class="col-md-4">
                                                                                    <h4>
                                                                                        <a href="javascript:void(0)">
                                                                                            Cronograma
                                                                                        </a>
                                                                                        <small>a travez de trimestres</small>
                                                                                    </h4>
                                                                                </td>
                                                                                <td class="text-center" style="width: 40px;"><i class="fa fa-file fa-2x text-muted"></i></td>
                                                                                <td class="col-md-4">
                                                                                    <h4>
                                                                                        <a href="javascript:void(0)">
                                                                                            PEI
                                                                                        </a>
                                                                                        <small>Plan estratégico institucional</small>
                                                                                    </h4>
                                                                                </td>
                                                                                <td class="text-center" style="width: 40px;"><i class="fa fa-database fa-2x text-muted"></i></td>
                                                                                <td class="col-md-4">
                                                                                    <h4>
                                                                                        <a href="javascript:void(0)">
                                                                                            Otros datos
                                                                                        </a>
                                                                                        <small>MEF y unidades</small>
                                                                                    </h4>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td colspan="2" >                                                      
                                                                                    <table class="table table-condensed table-hover">
                                                                                        <tbody>
                                                                                            <ui:repeat value="#{viewPOIBean.quarters}" var="q">
                                                                                                <tr>
                                                                                                    <th  style="width: 140px;min-width: 140px;max-width: 140px" class="text-right">
                                                                                                        <h:outputText value="#{q.name}" escape="false"></h:outputText>  :
                                                                                                    </th>
                                                                                                    <td>
                                                                                                        #{item['schedule'][q.id]}
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </ui:repeat>
                                                                                            <tr>
                                                                                                <th  style="width: 140px;min-width: 140px;max-width: 140px" class="text-right">
                                                                                                    Total :
                                                                                                </th>
                                                                                                <td>
                                                                                                    #{item['total']}
                                                                                                </td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </td>
                                                                                <td colspan="2" >                                       
                                                                                    <table class="table table-condensed table-hover">
                                                                                        <tbody>
                                                                                            <tr>
                                                                                                <th  style="width: 100px;min-width: 100px;max-width: 100px;vertical-align: middle !important">
                                                                                                    Eje estr :
                                                                                                </th>
                                                                                                <td class="font-xs text-justify">
                                                                                                    #{item['strategicAxisName']} <small><strong>(#{item['strategicAxisCode']})</strong></small>
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <th  style="width: 100px;min-width: 100px;max-width: 100px;vertical-align: middle !important">
                                                                                                    Obj. estr. :
                                                                                                </th>
                                                                                                <td class="font-xs text-justify">
                                                                                                    #{item['strategicGoalName']} <small><strong>(#{item['strategicGoalCode']})</strong></small>
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <th  style="width: 100px;min-width: 100px;max-width: 100px;vertical-align: middle !important">
                                                                                                    Act. estr. :
                                                                                                </th>
                                                                                                <td class="font-xs text-justify">
                                                                                                    #{item['strategicActivityName']} <small><strong>(#{item['strategicActivityCode']})</strong></small>
                                                                                                </td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </td>
                                                                                <td colspan="2" class="no-padding" >                                                                        
                                                                                    <table class="table table-condensed table-hover">
                                                                                        <tbody>
                                                                                            <tr>
                                                                                                <th  style="width: 110px;min-width: 110px;max-width: 110px;vertical-align: middle !important">
                                                                                                    Act. presup. :
                                                                                                </th>
                                                                                                <td class="font-sm text-justify">
                                                                                                    #{item['activityBudgetProgramName']} <small><strong>(#{item['activityBudgetProgramCode']})</strong></small>
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <th  style="width: 100px;min-width: 100px;max-width: 100px;vertical-align: middle !important">
                                                                                                    Unidad :
                                                                                                </th>
                                                                                                <td class="font-sm text-justify">
                                                                                                    #{item['poiUnityName']} <small><strong>(#{item['poiUnityCode']})</strong></small>
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <th  style="width: 100px;min-width: 100px;max-width: 100px;vertical-align: middle !important">
                                                                                                    Factor :
                                                                                                </th>
                                                                                                <td class="font-sm">
                                                                                                    asdasdasd 
                                                                                                </td>
                                                                                            </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </ui:repeat>
                                                    </tbody>
                                                    <ui:fragment rendered="false">
                                                        <tfoot>
                                                            <tr class="text-muted">
                                                                <td colspan="3">
                                                                    <h3>Ningúna Actividad  específica</h3>
                                                                </td>
                                                            </tr>
                                                        </tfoot>
                                                    </ui:fragment>
                                                </table>
                                                <ui:include src="/layout/pagination_footer.xhtml">
                                                    <ui:param name="pagination" value="#{viewPOIBean.pagination}"/>
                                                </ui:include>
                                            </div>
                                        </div>

                                    </h:form>
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td>
                                <h3>Descargas</h3>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <a href="javascript:$('#modal-download').modal()" class="btn btn-primary">
                                            <span class="fa fa-download"/> Descargar Informe
                                        </a>
                                        <a class="btn btn-info">
                                            <span class="fa fa-download"/> Descargar articulación MEF
                                        </a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>


    </div>

    <div class="modal fade" id="modal-download" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title"><i class="fa fa-download"/> Exportar programas presupuestales</h4>
                </div>
                <h:form id="report-form" styleClass="form-horizontal">
                    <div class="modal-body">
                        <div class="form-horizontal">
                            <div class="form-group">
                                <label class="col-md-2 control-label">Reporte</label>
                                <div class="col-md-10">
                                    <script>
                                        $(function () {
                                            $("#report-form\\:report").select2({
                                                placeholder: "Seleccione un reporte",
                                                width: "100%"
                                            });
                                        });
                                    </script>
                                    <h:selectOneMenu id="report" value="#{viewPOIBean.report.selectedCode}">
                                        <f:selectItem/>
                                        <f:selectItems value="#{viewPOIBean.report.staticReports}" var="r" itemValue="#{r.code}" itemLabel="#{r.name}"/>
                                        <p:ajax process="report" event="change" update="report-form:parameters-wrapper"/>
                                    </h:selectOneMenu>
                                </div>
                            </div>
                            <h:panelGroup layout="block" id="parameters-wrapper">
                                <ui:fragment rendered="#{viewPOIBean.report.selected ne null}">
                                    <ui:repeat value="#{viewPOIBean.report.selected.parameters}" var="parameter" >
                                        <h:outputText value="#{parameter.makeHtml()}" escape="false"/>
                                    </ui:repeat>
                                </ui:fragment>
                            </h:panelGroup>
                            <a onclick="ReportView.report(this, 'XLSX', 'bg-color-green', 'txt-color-green')" style="width: 24%" class="btn btn-default btn-lg">
                                <i class="fa fa-3x fa-file-excel-o txt-color-green"></i>
                                <hr style="margin-top: 5px;margin-bottom: 5px"/>
                                MS Excel
                            </a>
                            <a onclick="ReportView.report(this, 'PDF', 'bg-color-red', 'txt-color-red')" style="width: 24%" class="btn btn-default btn-lg">
                                <i class="fa fa-3x fa-file-pdf-o txt-color-red"></i>
                                <hr style="margin-top: 5px;margin-bottom: 5px"/>
                                PDF
                            </a>
                            <a  onclick="ReportView.report(this, 'DOCX', 'bg-color-blue', 'txt-color-blue')"  style="width: 24%" class="btn btn-default btn-lg">
                                <i class="fa fa-3x fa-file-word-o txt-color-blue"></i>
                                <hr style="margin-top: 5px;margin-bottom: 5px"/>
                                MS Word
                            </a>
                            <a onclick="ReportView.report(this, 'TXT', 'bg-color-darken', 'text-muted')"   style="width: 24%" class="btn btn-default btn-lg">
                                <i class="fa fa-3x fa-file-text-o text-muted"></i>
                                <hr style="margin-top: 5px;margin-bottom: 5px"/>
                                Texto plano
                            </a>
                            <a onclick="ReportView.report(this, 'DBASE', 'btn-warning', 'text-warning')"  style="width: 24%" class="btn btn-default btn-lg">
                                <i class="fa fa-3x fa-database text-warning"></i>
                                <hr style="margin-top: 5px;margin-bottom: 5px"/>
                                dBase
                            </a>
                            <a onclick="ReportView.report(this, 'HTML', 'bg-color-purple', 'txt-color-purple')" style="width: 24%" class="btn btn-default btn-lg">
                                <i class="fa fa-3x fa-file-code-o txt-color-purple"></i>
                                <hr style="margin-top: 5px;margin-bottom: 5px"/>
                                HTML
                            </a>
                            <hr style="margin-top: 5px;margin-bottom: 5px"/>
                            <h:inputHidden id="content-type" value="#{viewPOIBean.report.contentType}" />>
                            <h:inputHidden id="parameters" value="#{viewPOIBean.report.parameters}" />
                            <p:commandLink id="download-rp" ajax="false"  styleClass="hidden" action="#{viewPOIBean.report.execute()}" process="@form"/>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button"  class="btn btn-primary" onclick="ReportView.download()" >
                            Descargar
                        </button>
                    </div>
                </h:form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>

    <div class="modal fade" id="modal-manage">
        <div class="modal-dialog modal-lg">
            <h:panelGroup id="manage-wrapper" layout="block" styleClass="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title"><i class="fa #{managedPOIBean.selected.id eq null ? 'fa-plus' : 'fa-edit'}"/> #{managedPOIBean.selected.id eq null ? 'Creando Actividad' : 'Editando actividad'}</h4>
                </div>
                <h:form id="form-manage" styleClass="form-horizontal">
                    <script>
                        $(function () {
                            POIView.configureManageForm();
                        });
                    </script>  
                    <div class="modal-body">
                        <div class="form-horizontal">
                            <h:panelGroup id="sgp-wrapper" layout="block" styleClass="form-group">
                                <label class="col-lg-2 col-md-3 control-label">Objetivo Estr.</label>
                                <div class="col-lg-10 col-md-9">
                                    <ui:fragment rendered="#{not empty managedPOIBean.specificGoalSearcher.data}">
                                        <script>
                                            $(function () {
                                                $("#form-manage\\:spg").select2({
                                                    width: "100%",
                                                    placeholder: "SELECCIONAR"
                                                });
                                            });
                                        </script>  
                                        <h:selectOneMenu value="#{managedPOIBean.specificGoalSearcher.selected}" id="spg">
                                            <f:selectItem/>
                                            <f:selectItems 
                                                value="#{managedPOIBean.specificGoalSearcher.data}" />
                                            <p:ajax event="change" listener="#{managedPOIBean.specificGoalSearcher.change()}" update="form-manage:abp-wrapper,form-manage:act-wrapper"/>
                                        </h:selectOneMenu>
                                    </ui:fragment>
                                    <ui:fragment rendered="#{empty managedPOIBean.specificGoalSearcher.data}">
                                        <p class="form-control-static"><span class="label label-danger">No se ha configurado los objetivos especificos de esta dependencia</span></p>
                                    </ui:fragment>
                                </div>
                            </h:panelGroup>
                            <h:panelGroup id="act-wrapper" layout="block" styleClass="form-group">
                                <label class="col-lg-2 col-md-3 control-label">Estrategia <span style="font-size: 8px;font-weight: bold">( ACTIVIDAD )</span></label>

                                <div class="col-lg-10 col-md-9">
                                    <script>
                                        $(function () {
                                            $("#form-manage\\:specific-activity").select2({
                                                width: "100%",
                                                placeholder: "Seleccione una actividad especifica"
                                            })
                                        })
                                    </script>
                                    <h:selectOneMenu  value="#{managedPOIBean.specificActivity}"  id="specific-activity">
                                        <f:selectItem/>
                                        <f:selectItems 
                                            value="#{managedPOIBean.specificActivitySearcher.data}" 
                                            var="item" itemLabel="#{item[2]}" itemValue="#{item[0]}"/>
                                        <p:ajax event="change" listener="#{managedPOIBean.abpSearcher.update()}" update="form-manage:abp-wrapper"/>
                                    </h:selectOneMenu>
                                </div>
                            </h:panelGroup>
                            <h:panelGroup id="abp-wrapper" layout="block" styleClass="form-group">
                                <label class="col-lg-2 col-md-3 control-label">Act. presupuestal</label>
                                <div class="col-lg-10 col-md-9">
                                    <script>
                                        $(function () {
                                            $("#form-manage\\:activity-budge-program").select2({
                                                width: "100%",
                                                placeholder: "Seleccione una actividad presupuestal"
                                            });
                                        });
                                    </script> 
                                    <h:selectOneMenu value="#{managedPOIBean.activityBudgetProgram}" id="activity-budge-program">
                                        <f:selectItem/>
                                        <f:selectItems 
                                            value="#{managedPOIBean.abpSearcher.data}" 
                                            var="item" itemLabel="#{item[2]}" itemValue="#{item[0]}"/>
                                    </h:selectOneMenu>
                                </div>
                            </h:panelGroup>
                            <div class="form-group">
                                <label class="col-lg-2 col-md-3 control-label">Actividad</label>
                                <div class="col-lg-10 col-md-9">
                                    <h:inputTextarea id="detail-act" value="#{managedPOIBean.detail}" rows="3" styleClass="form-control">

                                    </h:inputTextarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-lg-2 col-md-3 control-label">Unidad</label>
                                <div class="col-lg-10 col-md-9">
                                    <script>
                                        $(function () {
                                            $("#form-manage\\:poi-unity").select2({
                                                width: "100%",
                                                placeholder: "Seleccione una unidad"
                                            })
                                        })
                                    </script>
                                    <h:selectOneMenu value="#{managedPOIBean.poiUnity}" id="poi-unity">
                                        <f:selectItem/>
                                        <f:selectItems 
                                            value="#{managedPOIBean.poiUnitySearcher.data}" 
                                            var="item" itemLabel="#{item[1]} || #{item[2]}" itemValue="#{item[0]}"/>
                                    </h:selectOneMenu>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-2 col-md-3" >

                                </div>
                                <div class="col-md-6">
                                    <div class="row">
                                        <script>
                                            $(function () {
                                                $(".month-schedule").on("input", function () {
                                                    var amount = 0;
                                                    $(".month-schedule").each(function () {
                                                        var current = parseFloat(this.value);
                                                        if (isNaN(current)) {
                                                            current = 0;
                                                        }
                                                        amount = amount + current;
                                                    });
                                                    $("#total").html(amount);
                                                });
                                                $(".month-schedule").first().trigger("input");
                                            });
                                        </script>
                                        <ui:repeat value="#{viewPOIBean.quarters}"  var="item">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label class="col-lg-6 col-md-6 control-label">
                                                        <h:outputText value="#{item.name}" escape="false" /></label>
                                                    <div class="col-lg-6 col-md-6">
                                                        <h:inputText  value="#{managedPOIBean.schedules[item.id].quantity}" styleClass="form-control month-schedule">

                                                        </h:inputText>
                                                    </div>
                                                </div>
                                            </div>
                                        </ui:repeat>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-lg-12 control-label text-center">Prioridad</label>
                                        <div class="col-lg-12 text-center">
                                            <h:inputText id="priority"  value="#{managedPOIBean.priority}" styleClass="form-control">

                                            </h:inputText>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-lg-12 control-label text-center">Total</label>
                                        <div class="col-lg-12 text-center">
                                            <p id="total" class="form-control-static font-lg txt-color-blue">14</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <label class="checkbox-inline pull-left">
                            <h:selectBooleanCheckbox disabled="#{managedPOIBean.selected.id ne null}" value="#{managedPOIBean.createAgain}"  id="create-again" styleClass="checkbox" />
                            <span>Crear nuevo al terminar</span>
                        </label>
                        <p:remoteCommand name="saveManage"  update=":form-table,:manage-wrapper" oncomplete="POIView.endSaveManage()" action="#{managedPOIBean.doSave(null, null)}"/>
                        <button type="button" id="btn-save-manage" onclick="POIView.saveManage()" style="margin-left: 15px" class="btn btn-sm btn-primary" >
                            Guardar
                            <i class="hidden fa fa-spin fa-refresh"/>
                        </button>
                    </div>
                </h:form>
            </h:panelGroup><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <ui:fragment rendered="#{sessionBean.authorize('VA_POI')}">
        <div class="modal fade" id="modal-chooser" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title"><i class="fa fa-building"/> Escoger una dependencia </h4>
                    </div>
                    <h:form id="chooser-form" >
                        <div class="modal-body">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="control-label col-md-2">Dependencia</label>
                                    <div class="col-md-10">
                                        <script>
                                            $(function () {
                                                $("#chooser-form\\:dependency").select2({
                                                    width: '100%',
                                                    placeholder: 'Escoja una dependencia'
                                                })
                                            });
                                        </script>
                                        <h:selectOneMenu id="dependency" value="#{poiBean.selected}">
                                            <f:selectItem/>
                                            <f:selectItems
                                                value="#{poiBean.dependencies}" var="item" itemValue="#{item[0]}" itemLabel="#{item[2]}"/>
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <p:commandLink action="#{poiBean.begin()}" update=":main" onstart="$('#modal-chooser .close').trigger('click')"   styleClass="btn btn-info">
                                Ver
                            </p:commandLink>
                        </div>
                    </h:form>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div>
    </ui:fragment>
</ui:composition>

